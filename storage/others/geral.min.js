var dbLocal={clientesDB:[],parceirosDB:[]};function busca(){let localBusca=$("#localBusca").val(),textoBusca=$("#textoBusca").val();switch(localBusca){case"":default:$("#localBusca").focus();break;case"clientes":if(""!=textoBusca.trim()){let t=textoBusca.trim().toLowerCase(),cl=$.grep(dbLocal.clientesDB,(function(element,indice){return element.nome.toLowerCase().indexOf(t)>-1||element.sobrenome.toLowerCase().indexOf(t)>-1||element.cidade.toLowerCase().indexOf(t)>-1||element.email.toLowerCase().indexOf(t)>-1}));if(console.log(cl),$("#busca .database").html('<div style="overflow-x:auto; width:100%;"><table class="table table-sm table-striped table-bordered"><thead class="bg-primary text-white"><tr> <th>Nome</th> <th>Sobrenome</th> <th>Email</th> <th>Cidade</th> <th>Estado</th> <th></th> </tr></thead><tbody class="show"></tbody></table></div>'),0==cl.length)$("#busca .database table tbody").append('<tr><td colapsn="6" class="text-center">Nada encontrado... Tente de novo</td></tr>'),$("#busca .database").prepend("<div>Mostrando 0 encontrados de "+dbLocal.clientesDB.length+" registros.</div>");else{cl.length>1e3&&alert("A pesquisa retornou mais de 1000 resultados. Para evitar problemas no navegador, só serão exibidos 1000 resultados. Tente refinar a busca...");let conta=0;for(let i=0;i<1e3&&null!=cl[i];i++){let x=cl[i];console.log(i,x),$("#busca .database table tbody").append("<tr> <td>"+x.nome+"</td> <td>"+x.sobrenome+"</td> <td>"+x.email+"</td> <td>"+x.cidade+"</td> <td>"+x.estado+"</td> <td></td> </tr>"),conta++}$("#busca .database").prepend("<div>Mostrando "+conta+" encontrados de "+dbLocal.clientesDB.length+" registros.</div>")}}else $("#textoBusca").focus()}}function writeClienteDB(db){let limiteLinhas=25,pages=0;$("#clientes").find(".card-body").html('<div style="overflow-x:auto; width:100%;"><table class="table table-sm table-striped table-bordered" id="clientes"><thead class="bg-primary text-white"><tr> <th>Nome</th> <th>Email</th> <th>Cidade</th> <th>Estado</th> <th></th> </tr></thead></table></div>'),$("#clientes").find(".card-body").append('<div class="d-flex justify-content-between"><div><ul class="pagination pagination-sm justify-content-end"></ul></div></div>');let i=0;for($("#clientes table").find("tbody").remove(),db.forEach((function(x){25==i&&(i=0),0==i&&(pages++,$("#clientes table").append('<tbody data-page="'+pages+'"></tbody>'));let criadoEm=new Date(x.criado_em);$("#clientes table").find("tbody").last().append("<tr> <td>"+x.nome+"</td> <td>"+x.email+"</td> <td>"+x.cidade+"</td> <td>"+x.estado+"</td> <td></td> </tr>"),i++})),$("#clientes table").find("tbody").first().addClass("show"),$("#clientes .pagination").children().remove(),$("#clientes .pagination").append('<li class="page-item disabled"><a class="page-link" data-go-prev href="javascript:void(0)">Anterior</a></li>'),i=0;i<pages;i++)$("#clientes .pagination").append('<li class="page-item"><a class="page-link" data-goto="'+(i+1)+'" href="javascript:void(0)">'+(i+1)+"</a></li>");$("#clientes .pagination").append('<li class="page-item"><a class="page-link" data-go-next href="javascript:void(0)">Próximo</a></li>'),$("#clientes .pagination").find('[data-goto="1"]').trigger("click")}function sidebarAutoHide(){$("body").outerWidth()>576?$("#sidebar").addClass("show"):$("#sidebar").removeClass("show")}function loadDBLocal(){rawClientes.forEach((function(c){let x=JSON.parse(c);x.forEach((function(d){dbLocal.clientesDB.push(d)})),x=void 0})),rawClientes=void 0,writeClienteDB(dbLocal.clientesDB)}$(document).ready((function(){sidebarAutoHide(),loadDBLocal(),$(window).resize((function(){sidebarAutoHide()})),$(document).on("click","[data-sidebar-toggle]",(function(ev){ev.stopPropagation(),ev.preventDefault(),$("#sidebar").hasClass("show")?$("#sidebar").removeClass("show"):$("#sidebar").addClass("show")})),$(document).on("click",'[data-toggle="pill"]',(function(ev){$(".page-header-title").text($(this).text())})),$(document).on("click",".database .page-link",(function(ev){ev.preventDefault(),ev.stopPropagation();let pagelink=$(this),pagination=$(this).parents(".pagination");if(null!=$(this).data("go-prev")){let atual=parseInt($(this).parents(".database").eq(0).find("tbody.show").data("page"));atual>1&&(atual--,$(this).parents(".database").eq(0).find("tbody.show").removeClass("show"),$(this).parents(".database").eq(0).find('[data-page="'+atual+'"]').addClass("show"))}else if(null!=$(this).data("go-next")){let atual=parseInt($(this).parents(".database").eq(0).find("tbody.show").data("page"));atual<$(this).parents(".database").eq(0).find("tbody").length&&(atual++,$(this).parents(".database").eq(0).find("tbody.show").removeClass("show"),$(this).parents(".database").eq(0).find('[data-page="'+atual+'"]').addClass("show"))}else{let pagina=$(this).data("goto");0==$(this).parents(".database").eq(0).find('tbody[data-page="'+pagina+'"]').hasClass("show")&&($(this).parents(".database").eq(0).find("tbody.show").removeClass("show"),$(this).parents(".database").eq(0).find('tbody[data-page="'+pagina+'"]').addClass("show"))}let pagAtual=parseInt($(this).parents(".database").eq(0).find("tbody.show").data("page")),pagTotal=parseInt($(this).parents(".database").eq(0).find("tbody").length);pagination.find(".active").removeClass("active"),pagination.find('[data-goto="'+pagAtual+'"]').parents(".page-item").addClass("active"),1==pagAtual&&(pagination.find("[data-go-prev]").parents(".page-item").addClass("disabled"),pagination.find("[data-go-next]").parents(".page-item").removeClass("disabled")),pagAtual==pagTotal&&(pagination.find("[data-go-prev]").parents(".page-item").removeClass("disabled"),pagination.find("[data-go-next]").parents(".page-item").addClass("disabled")),1==pagAtual&&pagAtual==pagTotal&&pagination.find("[data-go-prev], [data-go-next]").parents(".page-item").addClass("disabled"),pagAtual>1&&pagAtual<pagTotal&&(pagination.find("[data-go-prev]").parents(".page-item").removeClass("disabled"),pagination.find("[data-go-next]").parents(".page-item").removeClass("disabled"))}))}));